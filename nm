https://github.com/mackyle/striptease/blob/master/nm.c
